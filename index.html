<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iowa Cooperative Businesses | Interactive Collage</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=DM+Sans:wght@400;500;600&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --text-primary: #f5f5f7;
            --text-secondary: #8b8b99;
            --accent-gold: #d4a853;
            --accent-teal: #4fd1c5;
            --card-border: rgba(255, 255, 255, 0.08);
            --glow: rgba(79, 209, 197, 0.15);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body {
            overflow: hidden;
            height: 100%;
            width: 100%;
            background: var(--bg-primary);
            font-family: 'DM Sans', sans-serif;
            color: var(--text-primary);
        }
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
            opacity: 0.03;
            pointer-events: none;
            z-index: 10000;
        }
        .header {
            position: fixed;
            top: 0; left: 0; right: 0;
            z-index: 1000;
            padding: 24px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(to bottom, rgba(10, 10, 15, 0.95) 0%, rgba(10, 10, 15, 0) 100%);
            pointer-events: none;
        }
        .header > * { pointer-events: auto; }
        .logo {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 700;
        }
        .logo span { color: var(--accent-gold); }
        .controls { display: flex; align-items: center; gap: 16px; }
        .zoom-display {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            color: var(--text-secondary);
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--card-border);
            padding: 8px 16px;
            border-radius: 8px;
            min-width: 80px;
            text-align: center;
        }
        .btn {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--card-border);
            color: var(--text-primary);
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'DM Sans', sans-serif;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .btn:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: var(--accent-teal);
            box-shadow: 0 0 20px var(--glow);
        }
        .btn-icon { padding: 10px; width: 42px; height: 42px; display: flex; align-items: center; justify-content: center; }
        .filter-bar {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            display: flex;
            gap: 8px;
            padding: 8px;
            background: rgba(18, 18, 26, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            flex-wrap: wrap;
            justify-content: center;
            max-width: 90vw;
        }
        .filter-btn {
            padding: 10px 20px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-family: 'DM Sans', sans-serif;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        .filter-btn:hover { color: var(--text-primary); background: rgba(255, 255, 255, 0.05); }
        .filter-btn.active { background: var(--accent-teal); color: var(--bg-primary); }
        .canvas-container {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            overflow: hidden;
            cursor: grab;
        }
        .canvas-container:active { cursor: grabbing; }
        .collage-canvas {
            position: absolute;
            transform-origin: 0 0;
            will-change: transform;
        }
        .coop-card {
            position: absolute;
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
            transition: box-shadow 0.3s ease, left 0.4s ease, top 0.4s ease, opacity 0.3s ease;
            will-change: transform;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        }
        .coop-card:hover {
            box-shadow: 0 12px 50px rgba(0, 0, 0, 0.6), 0 0 80px var(--glow);
            z-index: 100;
        }
        .coop-card.filtered-out {
            opacity: 0;
            pointer-events: none;
        }
        .coop-screenshot {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            transition: transform 0.4s ease;
        }
        .coop-card:hover .coop-screenshot {
            transform: scale(1.05);
        }
        .coop-placeholder {
            width: 100%; height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        }
        .coop-placeholder-icon { font-size: 3rem; opacity: 0.5; }
        .coop-overlay {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.95) 0%, rgba(0, 0, 0, 0.6) 50%, transparent 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding: 20px;
        }
        .coop-card:hover .coop-overlay { opacity: 1; }
        .coop-name {
            font-family: 'Playfair Display', serif;
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 6px;
            line-height: 1.2;
            color: #fff;
        }
        .coop-location { font-size: 0.85rem; color: rgba(255, 255, 255, 0.7); margin-bottom: 8px; }
        .coop-type {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            padding: 5px 10px;
            border-radius: 4px;
            display: inline-block;
            width: fit-content;
        }
        .type-agricultural { background: rgba(76, 175, 80, 0.3); color: #a5d6a7; }
        .type-electric { background: rgba(255, 193, 7, 0.3); color: #ffe082; }
        .type-credit { background: rgba(33, 150, 243, 0.3); color: #90caf9; }
        .type-telecom { background: rgba(156, 39, 176, 0.3); color: #ce93d8; }
        .type-food { background: rgba(244, 67, 54, 0.3); color: #ef9a9a; }
        .type-housing { background: rgba(0, 188, 212, 0.3); color: #80deea; }
        .type-energy { background: rgba(255, 152, 0, 0.3); color: #ffcc80; }
        .type-worker { background: rgba(233, 30, 99, 0.3); color: #f48fb1; }
        .click-hint {
            position: absolute;
            top: 12px; right: 12px;
            background: rgba(0, 0, 0, 0.6);
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.8);
            opacity: 0;
            transition: opacity 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .coop-card:hover .click-hint { opacity: 1; }
        .stats {
            position: fixed;
            bottom: 90px; right: 24px;
            display: flex;
            gap: 16px;
            z-index: 999;
        }
        .stat {
            background: rgba(18, 18, 26, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid var(--card-border);
            border-radius: 12px;
            padding: 16px 20px;
            text-align: center;
        }
        .stat-value { font-family: 'Playfair Display', serif; font-size: 1.8rem; font-weight: 700; color: var(--accent-gold); }
        .stat-label { font-size: 0.75rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.1em; }
        .loading {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: var(--bg-primary);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            transition: opacity 0.5s ease;
        }
        .loading.hidden { opacity: 0; pointer-events: none; }
        .loading-spinner {
            width: 60px; height: 60px;
            border: 3px solid var(--card-border);
            border-top-color: var(--accent-teal);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .loading-text { margin-top: 24px; font-family: 'Playfair Display', serif; font-size: 1.2rem; color: var(--text-secondary); }
        .instructions {
            position: fixed;
            top: 100px; right: 24px;
            width: 280px;
            background: rgba(18, 18, 26, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 24px;
            z-index: 999;
            opacity: 0;
            transform: translateX(20px);
            animation: slideIn 0.6s ease 1s forwards;
        }
        @keyframes slideIn { to { opacity: 1; transform: translateX(0); } }
        .instructions h3 { font-family: 'Playfair Display', serif; font-size: 1.1rem; margin-bottom: 16px; color: var(--accent-gold); }
        .instructions ul { list-style: none; font-size: 0.9rem; color: var(--text-secondary); }
        .instructions li { margin-bottom: 12px; padding-left: 24px; position: relative; }
        .instructions li::before { content: '->'; position: absolute; left: 0; color: var(--accent-teal); }
        .instructions .dismiss { margin-top: 16px; width: 100%; background: transparent; border: 1px solid var(--card-border); }
    </style>
</head>
<body>
    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading Iowa Cooperatives...</div>
    </div>
    <header class="header">
        <div class="logo">Iowa <span>Cooperatives</span></div>
        <div class="controls">
            <div class="zoom-display" id="zoomDisplay">100%</div>
            <button class="btn btn-icon" id="zoomOut" title="Zoom Out">-</button>
            <button class="btn btn-icon" id="zoomIn" title="Zoom In">+</button>
            <button class="btn" id="resetView">Reset View</button>
        </div>
    </header>
    <div class="canvas-container" id="canvasContainer">
        <div class="collage-canvas" id="collageCanvas"></div>
    </div>
    <div class="filter-bar" id="filterBar">
        <button class="filter-btn active" data-filter="all">All</button>
        <button class="filter-btn" data-filter="agricultural">Agricultural</button>
        <button class="filter-btn" data-filter="electric">Electric</button>
        <button class="filter-btn" data-filter="credit">Credit Unions</button>
        <button class="filter-btn" data-filter="telecom">Telecom</button>
        <button class="filter-btn" data-filter="food">Food</button>
        <button class="filter-btn" data-filter="housing">Housing</button>
        <button class="filter-btn" data-filter="energy">Energy</button>
        <button class="filter-btn" data-filter="worker">Worker-Owned</button>
    </div>
    <div class="instructions" id="instructions">
        <h3>How to Navigate</h3>
        <ul>
            <li>Scroll to zoom in/out</li>
            <li>Click and drag to pan</li>
            <li>Pinch to zoom on touch</li>
            <li>Hover for cooperative info</li>
            <li>Click to visit website</li>
        </ul>
        <button class="btn dismiss" id="dismissInstructions">Got it!</button>
    </div>
    <div class="stats">
        <div class="stat"><div class="stat-value" id="totalCount">0</div><div class="stat-label">Cooperatives</div></div>
        <div class="stat"><div class="stat-value" id="visibleCount">0</div><div class="stat-label">Showing</div></div>
    </div>
    <script>
        const cooperatives = [
            { id: 1, name: "21st Century Cooperative", location: "Cumberland, IA", type: "Agricultural", website: "http://www.21stcoop.com/", category: "agricultural" },
            { id: 2, name: "AgState", location: "Cherokee, IA", type: "Agricultural", website: "https://agstate.org/", category: "agricultural" },
            { id: 3, name: "Archer Cooperative Grain", location: "Archer, IA", type: "Agricultural", website: "http://archercoopgrain.com/", category: "agricultural" },
            { id: 4, name: "Aspinwall Coop Company", location: "Aspinwall, IA", type: "Agricultural", website: "http://www.aspinwallcoop.com/", category: "agricultural" },
            { id: 5, name: "Buckingham Cooperative", location: "Buckingham, IA", type: "Agricultural", website: "http://www.buckingham.coop/", category: "agricultural" },
            { id: 6, name: "Cedar County Cooperative", location: "Tipton, IA", type: "Agricultural", website: "http://www.cedarcountycoop.com/", category: "agricultural" },
            { id: 7, name: "Cooperative Farmers Elevator", location: "Rock Valley, IA", type: "Agricultural", website: "http://www.coopfe.com/", category: "agricultural" },
            { id: 8, name: "Dunkerton Co-op Elevator", location: "Dunkerton, IA", type: "Agricultural", website: "http://www.dunkertoncoop.com/", category: "agricultural" },
            { id: 9, name: "Farm Service Cooperative", location: "Harlan, IA", type: "Agricultural", website: "http://www.fscoop.com/", category: "agricultural" },
            { id: 10, name: "Farmers Cooperative", location: "Keota, IA", type: "Agricultural", website: "http://www.keotafarmerscoop.com/", category: "agricultural" },
            { id: 11, name: "Farmers Co-op (Readlyn)", location: "Readlyn, IA", type: "Agricultural", website: "http://www.readlynshellrockcoop.com/", category: "agricultural" },
            { id: 12, name: "Farmers Cooperative (Radcliffe)", location: "Radcliffe, IA", type: "Agricultural", website: "https://www.radcliffecoop.com/", category: "agricultural" },
            { id: 13, name: "Farmers Cooperative (Craig)", location: "Craig, IA", type: "Agricultural", website: "http://craigcoop.com/", category: "agricultural" },
            { id: 14, name: "Farmers Cooperative (Remsen)", location: "Remsen, IA", type: "Agricultural", website: "http://www.remsencoop.com/", category: "agricultural" },
            { id: 15, name: "Farmers Cooperative (Ottosen)", location: "Ottosen, IA", type: "Agricultural", website: "http://www.ottosenelevator.com/", category: "agricultural" },
            { id: 16, name: "Farmers Cooperative (Arcadia)", location: "Arcadia, IA", type: "Agricultural", website: "http://www.faccooperative.com/", category: "agricultural" },
            { id: 17, name: "Farmers Cooperative Society", location: "Sioux Center, IA", type: "Agricultural", website: "http://www.farmerscoopsociety.com/", category: "agricultural" },
            { id: 18, name: "Farmers Union Cooperative", location: "Ossian, IA", type: "Agricultural", website: "http://www.farmerunion.net/", category: "agricultural" },
            { id: 19, name: "Farmers Win Cooperative", location: "Fredericksburg, IA", type: "Agricultural", website: "http://www.farmerswin.com/", category: "agricultural" },
            { id: 20, name: "Five Star Cooperative", location: "New Hampton, IA", type: "Agricultural", website: "https://www.fivestarcoop.com/", category: "agricultural" },
            { id: 21, name: "Gold-Eagle Cooperative", location: "Goldfield, IA", type: "Agricultural", website: "http://www.goldeaglecoop.com/", category: "agricultural" },
            { id: 22, name: "Heartland Co-op", location: "West Des Moines, IA", type: "Agricultural", website: "http://www.heartlandcoop.com/", category: "agricultural" },
            { id: 23, name: "Hull Cooperative", location: "Hull, IA", type: "Agricultural", website: "http://www.hullcoop.com/", category: "agricultural" },
            { id: 24, name: "Innovative Ag Services", location: "Monticello, IA", type: "Agricultural", website: "http://www.innovativeag.com/", category: "agricultural" },
            { id: 25, name: "Key Cooperative", location: "Roland, IA", type: "Agricultural", website: "http://www.keycoop.com/", category: "agricultural" },
            { id: 26, name: "Landus", location: "Des Moines, IA", type: "Agricultural", website: "https://www.landus.ag/", category: "agricultural" },
            { id: 27, name: "Linn Cooperative Oil Co.", location: "Marion, IA", type: "Agricultural", website: "https://www.linncoop.com/", category: "agricultural" },
            { id: 28, name: "Mid-Iowa Cooperative", location: "Beaman, IA", type: "Agricultural", website: "http://www.midiowacoop.com/", category: "agricultural" },
            { id: 29, name: "NEW Cooperative Inc.", location: "Fort Dodge, IA", type: "Agricultural", website: "http://www.newcoop.com/", category: "agricultural" },
            { id: 30, name: "Nexus Cooperative", location: "Charles City, IA", type: "Agricultural", website: "https://www.nexus.coop/", category: "agricultural" },
            { id: 31, name: "North Iowa Cooperative", location: "Thornton, IA", type: "Agricultural", website: "http://www.nicoop.com/", category: "agricultural" },
            { id: 32, name: "PRO Cooperative", location: "Pocahontas, IA", type: "Agricultural", website: "http://www.procooperative.com/", category: "agricultural" },
            { id: 33, name: "Producer Cooperative", location: "Gaza, IA", type: "Agricultural", website: "https://gazaproducerscoop.com/", category: "agricultural" },
            { id: 34, name: "River Valley Cooperative", location: "Davenport, IA", type: "Agricultural", website: "http://www.rivervalleycoop.com/", category: "agricultural" },
            { id: 35, name: "SilverEdge Cooperative", location: "Edgewood, IA", type: "Agricultural", website: "http://www.silveredgecoop.com/", category: "agricultural" },
            { id: 36, name: "Stateline Cooperative", location: "Burt, IA", type: "Agricultural", website: "http://www.statelinecoop.com/", category: "agricultural" },
            { id: 37, name: "Tama-Benton Cooperative", location: "Dysart, IA", type: "Agricultural", website: "http://www.tamabentoncoop.com/", category: "agricultural" },
            { id: 38, name: "Two Rivers Cooperative", location: "Pella, IA", type: "Agricultural", website: "http://www.tworivers.coop/", category: "agricultural" },
            { id: 39, name: "United Cooperative", location: "Webster City, IA", type: "Agricultural", website: "http://www.unitedcoop.com/", category: "agricultural" },
            { id: 40, name: "Access Energy Cooperative", location: "Mount Pleasant, IA", type: "Rural Electric", website: "http://www.accessenergycoop.com/", category: "electric" },
            { id: 41, name: "Allamakee-Clayton REC", location: "Postville, IA", type: "Rural Electric", website: "http://www.acrec.com/", category: "electric" },
            { id: 42, name: "Butler County REC", location: "Allison, IA", type: "Rural Electric", website: "http://www.butlerrec.coop/", category: "electric" },
            { id: 43, name: "Calhoun County Electric", location: "Rockwell City, IA", type: "Rural Electric", website: "https://www.calhounrec.coop/", category: "electric" },
            { id: 44, name: "Central Iowa Power Coop", location: "Cedar Rapids, IA", type: "Rural Electric", website: "http://www.cipco.net/", category: "electric" },
            { id: 45, name: "Chariton Valley Electric", location: "Albia, IA", type: "Rural Electric", website: "https://www.cvrec.com/", category: "electric" },
            { id: 46, name: "Consumers Energy Coop", location: "Marshalltown, IA", type: "Rural Electric", website: "https://www.consumersenergy.coop/", category: "electric" },
            { id: 47, name: "Corn Belt Power Coop", location: "Humboldt, IA", type: "Rural Electric", website: "http://www.cbpower.coop/", category: "electric" },
            { id: 48, name: "Corridor Energy Coop", location: "Marion, IA", type: "Rural Electric", website: "https://corridorenergy.coop/", category: "electric" },
            { id: 49, name: "East Central Iowa REC", location: "Urbana, IA", type: "Rural Electric", website: "http://www.ecirec.coop/", category: "electric" },
            { id: 50, name: "Farmers Electric Co-op", location: "Greenfield, IA", type: "Rural Electric", website: "http://www.farmersrec.com/", category: "electric" },
            { id: 51, name: "Franklin Rural Electric", location: "Hampton, IA", type: "Rural Electric", website: "https://www.franklinrec.coop/", category: "electric" },
            { id: 52, name: "Grundy County REC", location: "Grundy Center, IA", type: "Rural Electric", website: "http://www.grundycountyrecia.com/", category: "electric" },
            { id: 53, name: "Guthrie County REC", location: "Guthrie Center, IA", type: "Rural Electric", website: "http://www.guthrie-rec.coop/", category: "electric" },
            { id: 54, name: "Harrison County REC", location: "Woodbine, IA", type: "Rural Electric", website: "http://www.hcrec.coop/", category: "electric" },
            { id: 55, name: "Iowa Lakes Electric", location: "Estherville, IA", type: "Rural Electric", website: "http://www.ilec.org/", category: "electric" },
            { id: 56, name: "Midland Power Coop", location: "Jefferson, IA", type: "Rural Electric", website: "http://www.midlandpower.com/", category: "electric" },
            { id: 57, name: "Nishnabotna Valley REC", location: "Harlan, IA", type: "Rural Electric", website: "https://www.nvrec.com/", category: "electric" },
            { id: 58, name: "Northwest REC", location: "Orange City, IA", type: "Rural Electric", website: "http://www.nwrec.com/", category: "electric" },
            { id: 59, name: "Northwest Iowa Power", location: "LeMars, IA", type: "Rural Electric", website: "http://www.nipco.coop/", category: "electric" },
            { id: 60, name: "Raccoon Valley Electric", location: "Glidden, IA", type: "Rural Electric", website: "http://www.rvec.coop/", category: "electric" },
            { id: 61, name: "Cedar Falls Credit Union", location: "Cedar Falls, IA", type: "Credit Union", website: "http://www.cfccu.org/", category: "credit" },
            { id: 62, name: "Community Choice CU", location: "Johnston, IA", type: "Credit Union", website: "http://www.comchoicecu.org/", category: "credit" },
            { id: 63, name: "Community 1st CU", location: "Ottumwa, IA", type: "Credit Union", website: "https://www.c1stcreditunion.com/", category: "credit" },
            { id: 64, name: "Dupaco Community CU", location: "Dubuque, IA", type: "Credit Union", website: "https://www.dupaco.com/", category: "credit" },
            { id: 65, name: "Financial Plus CU", location: "West Des Moines, IA", type: "Credit Union", website: "https://secure.financialpluscu.com/", category: "credit" },
            { id: 66, name: "Greater Iowa CU", location: "Ames, IA", type: "Credit Union", website: "https://www.greateriowacu.org/", category: "credit" },
            { id: 67, name: "Green State CU", location: "North Liberty, IA", type: "Credit Union", website: "https://www.greenstate.org/", category: "credit" },
            { id: 68, name: "Farmers Co-op Telephone", location: "Dysart, IA", type: "Telecommunications", website: "http://www.fctc.coop/", category: "telecom" },
            { id: 69, name: "Farmers Mutual Telephone", location: "Harlan, IA", type: "Telecommunications", website: "http://www.fmctc.com/", category: "telecom" },
            { id: 70, name: "Heart of Iowa Comm.", location: "Union, IA", type: "Telecommunications", website: "http://www.heartofiowa.coop/", category: "telecom" },
            { id: 71, name: "Huxley Communications", location: "Huxley, IA", type: "Telecommunications", website: "http://www.huxcomm.net/", category: "telecom" },
            { id: 72, name: "Northwest Communications", location: "Havelock, IA", type: "Telecommunications", website: "https://ncn.net/", category: "telecom" },
            { id: 73, name: "South Slope Cooperative", location: "North Liberty, IA", type: "Telecommunications", website: "https://www.southslope.com/", category: "telecom" },
            { id: 74, name: "Western Iowa Telephone", location: "Lawton, IA", type: "Telecommunications", website: "https://www.wiatel.com/", category: "telecom" },
            { id: 75, name: "Iowa Food Cooperative", location: "Des Moines, IA", type: "Food/Consumer", website: "https://iowafood.coop/", category: "food" },
            { id: 76, name: "Oneota Food Cooperative", location: "Decorah, IA", type: "Food/Consumer", website: "https://oneotacoop.com/", category: "food" },
            { id: 77, name: "New Pioneer Food Co-op", location: "Iowa City, IA", type: "Food/Consumer", website: "https://www.newpi.coop/", category: "food" },
            { id: 78, name: "Frontier Co-op", location: "Norway, IA", type: "Food/Consumer", website: "https://www.frontiercoop.com/", category: "food" },
            { id: 79, name: "Morning Bell Coffee", location: "Ames, IA", type: "Worker-Owned", website: "https://morningbellcoffee.com/", category: "worker" },
            { id: 80, name: "River City Housing", location: "Iowa City, IA", type: "Housing", website: "https://rchc.coop/", category: "housing" },
            { id: 83, name: "Brown Deer Cooperative", location: "Coralville, IA", type: "Housing", website: "https://www.browndeercooperative.com", category: "housing" },
            { id: 84, name: "Cooperative Energy Co.", location: "Sibley, IA", type: "Energy", website: "http://www.coopenergyco.com/", category: "energy" },
            { id: 85, name: "Hancock County Co-op Oil", location: "Garner, IA", type: "Energy", website: "https://www.hancockcountycoop.com/", category: "energy" },
            { id: 86, name: "NuWay K&H Cooperative", location: "Clear Lake, IA", type: "Energy", website: "https://www.nuway-kandh.com/", category: "energy" },
            { id: 87, name: "W & H Oil Cooperative", location: "Humboldt, IA", type: "Energy", website: "http://www.whcoop.com/", category: "energy" },
            { id: 88, name: "Siouxland Energy Coop", location: "Sioux Center, IA", type: "Renewable Energy", website: "http://www.siouxlandenergy.com/", category: "energy" },
            { id: 89, name: 'Farmers Cooperative (Craig)', location: 'Craig, IA', type: 'Agricultural', website: 'http://www.craigcoop.com/', category: 'agricultural' },
            { id: 90, name: 'Ag Partners Cooperative', location: 'Iowa', type: 'Agricultural', website: 'https://www.agpartnerscoop.com/', category: 'agricultural' },
            { id: 91, name: 'Prairie Energy Cooperative', location: 'Clarion, IA', type: 'Electric', website: 'https://www.prairieenergy.coop/', category: 'electric' },
            { id: 92, name: 'T.I.P. Rural Electric Cooperative', location: 'Brooklyn, IA', type: 'Electric', website: 'https://www.tiprec.com/', category: 'electric' },
            { id: 93, name: 'Maquoketa Valley Electric Cooperative', location: 'Anamosa, IA', type: 'Electric', website: 'https://www.mvec.coop/', category: 'electric' },
            { id: 94, name: 'Veridian Credit Union', location: 'Waterloo, IA', type: 'Credit', website: 'https://www.veridiancu.org/', category: 'credit' },
            { id: 96, name: 'Eastern Iowa Light & Power Cooperative', location: 'Wilton, IA', type: 'Electric', website: 'https://www.easterniowa.com/', category: 'electric' },
            { id: 97, name: 'Southwest Iowa Rural Electric Cooperative', location: 'Corning, IA', type: 'Electric', website: 'https://www.swiarec.coop/', category: 'electric' },
            { id: 98, name: 'Western Iowa Power Cooperative (WIPCO)', location: 'Denison, IA', type: 'Electric', website: 'https://www.wipco.com/', category: 'electric' },
            { id: 99, name: 'Midland Power Cooperative', location: 'Jefferson, IA', type: 'Electric', website: 'https://www.midlandpower.coop/', category: 'electric' },
            { id: 100, name: 'Heartland Power Cooperative', location: 'Thompson, IA', type: 'Electric', website: 'https://www.heartlandpower.com/', category: 'electric' },
            { id: 101, name: 'Woodbury County Rural Electric Cooperative', location: 'Moville, IA', type: 'Electric', website: 'https://www.woodburyrec.com/', category: 'electric' },
            { id: 102, name: 'Lyon Rural Electric Cooperative', location: 'Rock Rapids, IA', type: 'Electric', website: 'https://www.lyonrec.coop/', category: 'electric' },
            { id: 103, name: 'Iowa Lakes Electric Cooperative', location: 'Estherville, IA', type: 'Electric', website: 'https://www.ilec.coop/', category: 'electric' },
            { id: 104, name: 'Clarke Electric Cooperative', location: 'Osceola, IA', type: 'Electric', website: 'https://www.cecnet.net/', category: 'electric' },
            { id: 105, name: 'Southern Iowa Electric Cooperative', location: 'Bloomfield, IA', type: 'Electric', website: 'https://www.sie.coop/', category: 'electric' },
            { id: 106, name: 'FINANCIAL PLUS Credit Union', location: 'West Des Moines, IA', type: 'Credit', website: 'https://www.financialpluscu.com/', category: 'credit' },
            { id: 107, name: 'COMMUNITY CHOICE Credit Union', location: 'JOHNSTON, IA', type: 'Credit', website: 'https://www.comchoicecu.org/', category: 'credit' },
            { id: 108, name: 'RIVER VALLEY Credit Union', location: 'AMES, IA', type: 'Credit', website: 'https://www.rvcu.org/', category: 'credit' },
            { id: 109, name: 'SERVE Credit Union', location: 'DES MOINES, IA', type: 'Credit', website: 'https://www.servecu.org/', category: 'credit' },
            { id: 110, name: 'UNITE Credit Union', location: 'Cedar Falls, IA', type: 'Credit', website: 'https://www.unite-cu.org/', category: 'credit' },
            { id: 111, name: 'IOWA HEARTLAND Credit Union', location: 'MASON CITY, IA', type: 'Credit', website: 'https://www.iowaheartland.org/', category: 'credit' },
            { id: 112, name: 'TELCO TRIAD COMMUNITY Credit Union', location: 'Sioux City, IA', type: 'Credit', website: 'https://www.telcotriad.org/', category: 'credit' },
            { id: 113, name: 'GREATER IOWA Credit Union', location: 'Ames, IA', type: 'Credit', website: 'https://www.gicu.org/', category: 'credit' },
            { id: 114, name: 'METCO Credit Union', location: 'Cedar Rapids, IA', type: 'Credit', website: 'https://www.metcocu.org/', category: 'credit' },
            { id: 115, name: 'Osceola Electric Cooperative', location: 'Sibley, IA', type: 'Electric', website: 'https://www.osceolaelectric.com/', category: 'electric' },
            { id: 116, name: 'L&O Power Cooperative', location: 'Rock Rapids, IA', type: 'Electric', website: 'https://www.landopowercoop.com/', category: 'electric' },
            { id: 117, name: 'Coon Valley Telecommunications Cooperative', location: 'Manning, IA', type: 'Telecom', website: 'https://www.coonvalleytelco.com/', category: 'telecom' },
            { id: 118, name: 'Northeast Iowa Telephone Company', location: 'Monona, IA', type: 'Telecom', website: 'https://www.neitel.com/', category: 'telecom' },
            { id: 119, name: 'CORDA Credit Union', location: 'Cedar Rapids, IA', type: 'Credit', website: 'https://www.cordacu.org/', category: 'credit' },
            { id: 120, name: 'JOURNEY Credit Union', location: 'Des Moines, IA', type: 'Credit', website: 'https://www.journeycu.org/', category: 'credit' },
            { id: 121, name: 'RIVER COMMUNITY Credit Union', location: 'Ottumwa, IA', type: 'Credit', website: 'https://www.rivercommunitycu.org/', category: 'credit' },
            { id: 122, name: 'MiEnergy Cooperative', location: 'Cresco, IA', type: 'Electric', website: 'https://www.mienergy.coop/', category: 'electric' },
            { id: 123, name: 'FAMILY COMMUNITY Credit Union', location: 'Charles City, IA', type: 'Credit', website: 'https://www.familycommunitycu.com/', category: 'credit' },
            { id: 124, name: 'ASCENTRA Credit Union', location: 'Bettendorf, IA', type: 'Credit', website: 'https://www.ascentra.org/', category: 'credit' },
            { id: 125, name: 'Premier Cooperative', location: 'Reinbeck, IA', type: 'Agricultural', website: 'https://www.premiercooperative.com/', category: 'agricultural' },
            { id: 126, name: 'DU TRAC COMMUNITY Credit Union', location: 'DUBUQUE, IA', type: 'Credit', website: 'https://www.dutrac.org/', category: 'credit' },
            { id: 127, name: 'AFFINITY Credit Union', location: 'Des Moines, IA', type: 'Credit', website: 'https://www.affinitycuia.org/', category: 'credit' },
            { id: 128, name: 'Winnebago Cooperative Telecom Association', location: 'Lake Mills, IA', type: 'Telecom', website: 'https://www.wctatel.net/', category: 'telecom' },
            { id: 129, name: 'CENT Credit Union', location: 'Mason City, IA', type: 'Credit', website: 'https://www.centcu.org/', category: 'credit' },
            { id: 130, name: 'MEMBERS1ST COMMUNITY Credit Union', location: 'Marshalltown, IA', type: 'Credit', website: 'https://www.members1st.com/', category: 'credit' },
            { id: 131, name: 'FORT DODGE FAMILY Credit Union', location: 'Fort Dodge, IA', type: 'Credit', website: 'https://www.fdfcu.com/', category: 'credit' },
            { id: 132, name: 'THE FAMILY Credit Union', location: 'Davenport, IA', type: 'Credit', website: 'https://www.familycu.com/', category: 'credit' },
            { id: 133, name: 'Pella Cooperative Electric Association', location: 'Pella, IA', type: 'Electric', website: 'https://www.pella-cea.org/', category: 'electric' },
            { id: 134, name: 'NORTH STAR COMMUNITY Credit Union', location: 'Cherokee, IA', type: 'Credit', website: 'https://www.nsccu.org/', category: 'credit' },
            { id: 135, name: 'ADVANTAGE Credit Union', location: 'Newton, IA', type: 'Credit', website: 'https://www.acuiowa.org/', category: 'credit' },
            { id: 136, name: 'FIRST Credit Union', location: 'Hiawatha, IA', type: 'Credit', website: 'https://www.firstfedcu.com/', category: 'credit' },
            { id: 137, name: '1ST GATEWAY Credit Union', location: 'Camanche, IA', type: 'Credit', website: 'https://www.1stgateway.org/', category: 'credit' },
            { id: 138, name: 'COMMUNITY 1ST Credit Union', location: 'Ottumwa, IA', type: 'Credit', website: 'https://www.community1stcu.com/', category: 'credit' },
            { id: 139, name: 'IOWA CREDIT UNION LEAGUE', location: 'WEST DES MOINES, IA', type: 'Credit', website: 'https://www.iowacreditunions.com/', category: 'credit' },
            { id: 140, name: 'COOPERATIVE TELEPHONE EXCHANGE', location: 'STANHOPE, IA', type: 'Telecom', website: 'https://www.cooptelexchange.com/', category: 'telecom' },
            { id: 141, name: 'NORTHWEST IOWA POWER COOPERATIVE', location: 'LE MARS, IA', type: 'Electric', website: 'https://www.nipco.coop/', category: 'electric' },
            { id: 142, name: 'FREMONT FUNERAL CHAPEL COOPERATIVE', location: 'FREMONT, IA', type: 'Other', website: 'https://www.fremontfuneralchapel.com/', category: 'other' },
            { id: 143, name: 'ASSOCIATED MILK PRODUCERS, INC.', location: 'NEW ULM, IA', type: 'Agricultural', website: 'https://www.ampi.com/', category: 'agricultural' },
            { id: 144, name: 'VAN HORNE COOPERATIVE TELEPHONE COMPANY', location: 'VAN HORNE, IA', type: 'Telecom', website: 'https://vanhornecommunications.com/', category: 'telecom' },
            { id: 145, name: 'COMMUNITY OIL COMPANY, A COOPERATIVE', location: 'ROCK VALLEY, IA', type: 'Energy', website: 'https://communityoilco.com/', category: 'energy' },
            { id: 146, name: 'ATCHISON-HOLT ELECTRIC COOPERATIVE', location: 'ROCK PORT, IA', type: 'Electric', website: 'https://www.ahec.coop/', category: 'electric' },
            { id: 147, name: 'GRUNDY COUNTY RURAL ELECTRIC COOPERATIVE', location: 'GRUNDY CENTER, IA', type: 'Electric', website: 'https://www.grundycountyrecia.com/', category: 'electric' },
            { id: 148, name: 'FARMERS ELECTRIC COOPERATIVE', location: 'KALONA, IA', type: 'Electric', website: 'https://www.farmersrec.com/', category: 'electric' },
            { id: 149, name: 'SPRINGVILLE COOPERATIVE TELEPHONE ASSOCIATION', location: 'SPRINGVILLE, IA', type: 'Telecom', website: 'https://springvilletelephone.com/', category: 'telecom' },
            { id: 150, name: 'BUTLER COUNTY RURAL ELECTRIC COOPERATIVE', location: 'ALLISON, IA', type: 'Electric', website: 'https://butlerrec.coop/', category: 'electric' },
            { id: 151, name: 'MARTELLE COOPERATIVE TELEPHONE ASSOCIATION', location: 'MARTELLE, IA', type: 'Telecom', website: 'https://martellecom.us/', category: 'telecom' },
            { id: 152, name: 'GUTHRIE COUNTY RURAL ELECTRIC COOPERATIVE ASSOCIATION', location: 'GUTHRIE CENTER, IA', type: 'Electric', website: 'https://www.guthrie-rec.coop/', category: 'electric' },
            { id: 153, name: 'OSAGE COOPERATIVE ELEVATOR', location: 'OSAGE, IA', type: 'Agricultural', website: 'https://osagecoop.com/', category: 'agricultural' },
            { id: 154, name: 'SIOUX HONEY ASSOCIATION, COOPERATIVE', location: 'SIOUX CITY, IA', type: 'Agricultural', website: 'https://siouxhoney.com/', category: 'agricultural' },
            { id: 155, name: 'RIVER VALLEY TELECOMMUNICATIONS COOP', location: 'GRAETTINGER, IA', type: 'Telecom', website: 'https://rvtc.net/', category: 'telecom' },
            { id: 156, name: 'MABEL COOPERATIVE TELEPHONE COMPANY', location: 'MABEL, IA', type: 'Telecom', website: 'https://www.mabeltel.coop/', category: 'telecom' },
            { id: 157, name: 'HEALTH ENTERPRISES COOPERATIVE', location: 'CEDAR RAPIDS, IA', type: 'Other', website: 'https://healthenterprises.org/', category: 'other' },
            { id: 158, name: 'WEBSTER-CALHOUN COOPERATIVE TELEPHONE ASSOCIATION', location: 'GOWRIE, IA', type: 'Telecom', website: 'https://www.wccta.com/', category: 'telecom' },
            { id: 159, name: 'PARTNER COMMUNICATIONS COOPERATIVE', location: 'GILMAN, IA', type: 'Telecom', website: 'https://www.pcctel.net/', category: 'telecom' },
            { id: 160, name: 'COOPERATIVE TELEPHONE COMPANY', location: 'VICTOR, IA', type: 'Telecom', website: 'https://www.ctctechnology.net/', category: 'telecom' },
            { id: 161, name: 'COOPERATIVE ENERGY COMPANY', location: 'SIBLEY, IA', type: 'Energy', website: 'https://www.coopenergyco.com/', category: 'energy' },
            { id: 162, name: 'PRODUCERS LIVE STOCK MARKETING ASSOCIATION', location: 'OMAHA, IA', type: 'Food', website: 'https://producers-livestock.com/', category: 'food' },
            { id: 163, name: 'O\'BRIEN COOPERATIVE FUNERAL ASSOCIATION', location: 'SANBORN, IA', type: 'Other', website: 'https://sanborn-hartleyfuneralhomes.com/', category: 'other' },
            { id: 164, name: 'CORN BELT POWER COOPERATIVE', location: 'HUMBOLDT, IA', type: 'Electric', website: 'https://www.cbpower.coop/', category: 'electric' },
            { id: 165, name: 'FEDERATED RURAL ELECTRIC ASSOCIATION', location: 'JACKSON, IA', type: 'Electric', website: 'https://federatedrea.coop/', category: 'electric' },
            { id: 166, name: 'NORTH ENGLISH COOPERATIVE TELEPHONE COMPANY', location: 'NORTH ENGLISH, IA', type: 'Telecom', website: 'https://northenglishtelephone.com/', category: 'telecom' },
            { id: 167, name: 'COOPERATIVE GAS AND OIL COMPANY', location: 'SIOUX CENTER, IA', type: 'Energy', website: 'http://www.coopgassc.com/', category: 'energy' },
            { id: 168, name: 'FARMERS COOPERATIVE TELEPHONE COMPANY', location: 'DYSART, IA', type: 'Telecom', website: 'https://fctc.coop/', category: 'telecom' },
            { id: 169, name: 'W & H COOPERATIVE OIL COMPANY', location: 'HUMBOLDT, IA', type: 'Energy', website: 'https://www.whcoop.com/', category: 'energy' },
            { id: 170, name: 'HUBBARD COOPERATIVE TELEPHONE ASSOCIATION', location: 'HUBBARD, IA', type: 'Telecom', website: 'https://hubbardtelephone.net/', category: 'telecom' },
            { id: 171, name: 'FENTON COOPERATIVE TELEPHONE COMPANY', location: 'FENTON, IA', type: 'Telecom', website: 'https://www.fentontelephone.com/', category: 'telecom' },
            { id: 172, name: 'WARREN COUNTY OIL COOPERATIVE ASSOCIATION', location: 'INDIANOLA, IA', type: 'Energy', website: 'https://warrencountyoil.com/', category: 'energy' },
            { id: 173, name: 'IOWA CREDIT UNION FOUNDATION, INC', location: 'WEST DES MOINES, IA', type: 'Credit', website: 'https://www.iowacreditunionfoundation.org/', category: 'credit' },
            { id: 174, name: 'NORTH WEST RURAL ELECTRIC COOPERATIVE', location: 'ORANGE CITY, IA', type: 'Electric', website: 'https://www.nwrec.coop/', category: 'electric' },
            { id: 175, name: 'EAST-CENTRAL IOWA RURAL ELECTRIC COOPERATIVE', location: 'URBANA, IA', type: 'Electric', website: 'https://ecirec.coop/', category: 'electric' },
            { id: 176, name: 'COOPERATIVE RESPONSE CENTER, INC.', location: 'AUSTIN, IA', type: 'Purchasing', website: 'https://www.crc.coop/', category: 'purchasing' },
            { id: 178, name: 'THE COOPERATIVE FINANCE ASSOCIATION, INC.', location: 'KANSAS CITY, IA', type: 'Purchasing', website: 'https://cfafs.com/', category: 'purchasing' },
            { id: 179, name: 'SIOUXLAND ENERGY COOPERATIVE', location: 'SIOUX CENTER, IA', type: 'Energy', website: 'https://www.siouxlandenergy.com/', category: 'energy' },
            { id: 181, name: 'AMERICAN PHARMACY COOPERATIVE, INC.', location: 'BESSEMER, IA', type: 'Other', website: 'https://www.apcinet.com/', category: 'other' },
            { id: 182, name: 'RACCOON VALLEY ELECTRIC COOPERATIVE', location: 'GLIDDEN, IA', type: 'Electric', website: 'https://www.rvec.coop/', category: 'electric' },
            { id: 183, name: 'EMPLOYER HEALTH CARE ALLIANCE COOPERATIVE', location: 'FITCHBURG, IA', type: 'Other', website: 'https://the-alliance.org/', category: 'other' },
            { id: 184, name: 'ROOTED CARROT COOPERATIVE MARKET', location: 'CEDAR FALLS, IA', type: 'Food', website: 'https://rootedcarrot.coop/', category: 'food' },
            { id: 185, name: 'NATIONAL INFORMATION SOLUTIONS COOPERATIVE, INC', location: 'MANDAN, IA', type: 'Purchasing', website: 'https://www.nisc.coop/', category: 'purchasing' },
            { id: 186, name: 'CREDIT UNION NATIONAL ASSOCIATION, INC.', location: 'MADISON, IA', type: 'Credit', website: 'https://www.cuna.org/', category: 'credit' },
            { id: 187, name: 'NATIONAL BLOOD TESTING COOPERATIVE', location: 'STONE MOUNTAIN, IA', type: 'Other', website: 'https://nbtc.coop/', category: 'other' },
            { id: 188, name: 'QCS PURCHASING COOPERATIVE', location: 'LISLE, IA', type: 'Purchasing', website: 'https://qcspurchasing.com/', category: 'purchasing' },
            { id: 189, name: 'THE CREDIT UNION LOAN SOURCE LLC', location: 'ALPHARETTA, IA', type: 'Credit', website: 'https://www.buyculsloans.com/', category: 'credit' },
            { id: 190, name: 'HEALTH ACCESS COOPERATIVE', location: 'JOHNSTON, IA', type: 'Other', website: 'https://healthaccesscooperative.com/', category: 'other' },
            { id: 191, name: 'NATIONAL COOPERATIVE GROCERS ASSOCIATION', location: 'ST. PAUL, IA', type: 'Food', website: 'https://www.ncg.coop/', category: 'food' },
            { id: 192, name: 'ENT CREDIT UNION', location: 'COLORADO SPRINGS, IA', type: 'Credit', website: 'https://www.ent.com/', category: 'credit' },
            { id: 193, name: 'SECURITY MUTUAL INSURANCE ASSOCIATION', location: 'ALLISON, IA', type: 'Mutual', website: 'https://www.securitymutualins.com/', category: 'mutual' },
            { id: 194, name: 'CENTURY MUTUAL INSURANCE ASSOCIATION', location: 'HARTLEY, IA', type: 'Mutual', website: 'http://www.centurymutualins.com/', category: 'mutual' },
            { id: 195, name: 'WELLABE MUTUAL HOLDING COMPANY', location: 'DES MOINES, IA', type: 'Mutual', website: 'https://www.wellabe.com/', category: 'mutual' },
            { id: 196, name: 'ALLIANCE MUTUAL INSURANCE ASSOCIATION', location: 'GARNAVILLO, IA', type: 'Mutual', website: 'https://alliancemutualins.com/', category: 'mutual' },
            { id: 197, name: 'WALCOTT MUTUAL INSURANCE ASSOCIATION', location: 'WALCOTT, IA', type: 'Mutual', website: 'http://www.walcottmutual.com/', category: 'mutual' },
            { id: 198, name: 'HEARTLAND MUTUAL INSURANCE ASSOCIATION', location: 'ALGONA, IA', type: 'Mutual', website: 'https://www.heartlandmutual.com/', category: 'mutual' },
            { id: 199, name: 'TAMA COUNTY MUTUAL INSURANCE ASSOCIATION', location: 'TRAER, IA', type: 'Mutual', website: 'https://www.tamacountymutual.com/', category: 'mutual' },
            { id: 200, name: 'GRUNDY MUTUAL INSURANCE ASSOCIATION', location: 'GRUNDY CENTER, IA', type: 'Mutual', website: 'https://www.grundymutual.com/', category: 'mutual' },
            { id: 201, name: 'HOWARD COUNTY MUTUAL INSURANCE ASSOCIATION', location: 'CRESCO, IA', type: 'Mutual', website: 'https://www.hcmcresco.com/', category: 'mutual' },
            { id: 202, name: 'FLOYD COUNTY MUTUAL INSURANCE ASSOCIATION', location: 'CHARLES CITY, IA', type: 'Mutual', website: 'https://www.floydcountymutual.com/', category: 'mutual' },
            { id: 203, name: 'TAMA-BENTON COOPERATIVE COMPANY', location: 'DYSART, IA', type: 'Agricultural', website: 'https://www.tamabentoncoop.com/', category: 'agricultural' },
            { id: 204, name: 'FCS COOPERATIVE', location: 'SIOUX CENTER, IA', type: 'Agricultural', website: 'https://www.farmerscoopsociety.com/', category: 'agricultural' },
            { id: 205, name: 'BUCKINGHAM CO-OPERATIVE CO.', location: 'BUCKINGHAM, IA', type: 'Agricultural', website: 'http://buckingham.coop/', category: 'agricultural' },
            { id: 206, name: 'EAGLE GROVE COOPERATIVE', location: 'AMES, IA', type: 'Agricultural', website: 'https://www.goldeaglecoop.com/', category: 'agricultural' },
            { id: 208, name: 'HULL COOPERATIVE ASSOCIATION', location: 'HULL, IA', type: 'Agricultural', website: 'https://www.hullcoop.com/', category: 'agricultural' },
            { id: 209, name: 'THE CONSUMERS COOPERATIVE SOCIETY', location: 'CORALVILLE, IA', type: 'Energy', website: 'https://consumerscoop.net/', category: 'energy' }
        ];

        // Masonry layout config
        const CARD_WIDTH = 260;
        const GAP = 16;
        const NUM_COLUMNS = 8;
        const SCREENSHOT_PATH = 'screenshots/';

        // Card height variations for masonry effect
        const HEIGHT_VARIANTS = [180, 220, 260, 200, 240];

        let scale = 1, translateX = 0, translateY = 0;
        let isDragging = false, startX, startY, dragStartTime;
        let currentFilter = 'all';
        let cardElements = [];
        let canvasWidth = 0, canvasHeight = 0;

        const canvas = document.getElementById('collageCanvas');
        const container = document.getElementById('canvasContainer');
        const zoomDisplay = document.getElementById('zoomDisplay');

        const typeClasses = {
            'Agricultural': 'type-agricultural',
            'Rural Electric': 'type-electric',
            'Credit Union': 'type-credit',
            'Telecommunications': 'type-telecom',
            'Food/Consumer': 'type-food',
            'Housing': 'type-housing',
            'Energy': 'type-energy',
            'Renewable Energy': 'type-energy',
            'Worker-Owned': 'type-worker'
        };

        const typeIcons = {
            'agricultural': 'ðŸŒ¾',
            'electric': 'âš¡',
            'credit': 'ðŸ¦',
            'telecom': 'ðŸ“¡',
            'food': 'ðŸ¥—',
            'housing': 'ðŸ ',
            'energy': 'ðŸ”‹',
            'worker': 'ðŸ¤'
        };

        function init() {
            createCards();
            setupEventListeners();
            updateStats();
            // Wait for images to start loading, then center
            requestAnimationFrame(() => {
                layoutCards();
                centerCanvas();
                setTimeout(() => document.getElementById('loading').classList.add('hidden'), 500);
            });
        }

        function getCardHeight(index) {
            // Use deterministic "random" heights based on index
            return HEIGHT_VARIANTS[index % HEIGHT_VARIANTS.length];
        }

        function createCards() {
            cooperatives.forEach((coop, index) => {
                const card = document.createElement('div');
                card.className = 'coop-card';
                card.dataset.category = coop.category;
                card.dataset.index = index;

                const height = getCardHeight(index);
                card.style.width = `${CARD_WIDTH}px`;
                card.style.height = `${height}px`;

                const typeClass = typeClasses[coop.type] || 'type-agricultural';
                const icon = typeIcons[coop.category] || 'ðŸ¢';
                const screenshotFile = `${String(coop.id).padStart(3, '0')}.png`;

                card.innerHTML = `
                    <img class="coop-screenshot" src="${SCREENSHOT_PATH}${screenshotFile}" alt="${coop.name}"
                         onerror="this.style.display='none';this.nextElementSibling.style.display='flex';">
                    <div class="coop-placeholder" style="display:none;">
                        <div class="coop-placeholder-icon">${icon}</div>
                    </div>
                    <div class="coop-overlay">
                        <h3 class="coop-name">${coop.name}</h3>
                        <p class="coop-location">${coop.location}</p>
                        <span class="coop-type ${typeClass}">${coop.type}</span>
                    </div>
                    <div class="click-hint">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6M15 3h6v6M10 14L21 3"/>
                        </svg>
                        Visit site
                    </div>
                `;

                card.addEventListener('click', (e) => {
                    if (Date.now() - dragStartTime < 200 && !isDragging) {
                        window.open(coop.website, '_blank', 'noopener,noreferrer');
                    }
                });

                canvas.appendChild(card);
                cardElements.push({ element: card, coop, height });
            });
        }

        function layoutCards() {
            // Get visible cards based on current filter
            const visibleCards = cardElements.filter(card => {
                const visible = currentFilter === 'all' || card.coop.category === currentFilter;
                card.element.classList.toggle('filtered-out', !visible);
                return visible;
            });

            // Initialize column heights
            const columnHeights = new Array(NUM_COLUMNS).fill(0);

            visibleCards.forEach((card) => {
                // Find the shortest column
                const minHeight = Math.min(...columnHeights);
                const columnIndex = columnHeights.indexOf(minHeight);

                // Position the card
                const x = columnIndex * (CARD_WIDTH + GAP);
                const y = columnHeights[columnIndex];

                card.element.style.left = `${x}px`;
                card.element.style.top = `${y}px`;

                // Update column height
                columnHeights[columnIndex] += card.height + GAP;
            });

            // Update canvas size
            canvasWidth = NUM_COLUMNS * (CARD_WIDTH + GAP) - GAP;
            canvasHeight = Math.max(...columnHeights);
            canvas.style.width = `${canvasWidth}px`;
            canvas.style.height = `${canvasHeight}px`;

            // Update visible count
            document.getElementById('visibleCount').textContent = visibleCards.length;
        }

        function setupEventListeners() {
            document.getElementById('zoomIn').addEventListener('click', () => zoom(1.25));
            document.getElementById('zoomOut').addEventListener('click', () => zoom(0.8));
            document.getElementById('resetView').addEventListener('click', centerCanvas);

            // Smooth wheel zoom
            container.addEventListener('wheel', (e) => {
                e.preventDefault();
                const delta = e.deltaY > 0 ? 0.9 : 1.1;
                zoom(delta, e.clientX, e.clientY);
            }, { passive: false });

            // Drag to pan
            container.addEventListener('mousedown', (e) => {
                dragStartTime = Date.now();
                isDragging = true;
                startX = e.clientX - translateX;
                startY = e.clientY - translateY;
                container.style.cursor = 'grabbing';
            });

            container.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                translateX = e.clientX - startX;
                translateY = e.clientY - startY;
                updateTransform();
            });

            container.addEventListener('mouseup', () => {
                isDragging = false;
                container.style.cursor = 'grab';
            });

            container.addEventListener('mouseleave', () => {
                isDragging = false;
                container.style.cursor = 'grab';
            });

            // Touch support
            let lastTouchDist = 0;
            let lastTouchCenter = { x: 0, y: 0 };

            container.addEventListener('touchstart', (e) => {
                dragStartTime = Date.now();
                if (e.touches.length === 2) {
                    lastTouchDist = Math.hypot(
                        e.touches[0].clientX - e.touches[1].clientX,
                        e.touches[0].clientY - e.touches[1].clientY
                    );
                    lastTouchCenter = {
                        x: (e.touches[0].clientX + e.touches[1].clientX) / 2,
                        y: (e.touches[0].clientY + e.touches[1].clientY) / 2
                    };
                } else if (e.touches.length === 1) {
                    isDragging = true;
                    startX = e.touches[0].clientX - translateX;
                    startY = e.touches[0].clientY - translateY;
                }
            }, { passive: false });

            container.addEventListener('touchmove', (e) => {
                e.preventDefault();
                if (e.touches.length === 2) {
                    const dist = Math.hypot(
                        e.touches[0].clientX - e.touches[1].clientX,
                        e.touches[0].clientY - e.touches[1].clientY
                    );
                    const center = {
                        x: (e.touches[0].clientX + e.touches[1].clientX) / 2,
                        y: (e.touches[0].clientY + e.touches[1].clientY) / 2
                    };
                    zoom(dist / lastTouchDist, center.x, center.y);
                    lastTouchDist = dist;
                    lastTouchCenter = center;
                } else if (e.touches.length === 1 && isDragging) {
                    translateX = e.touches[0].clientX - startX;
                    translateY = e.touches[0].clientY - startY;
                    updateTransform();
                }
            }, { passive: false });

            container.addEventListener('touchend', () => {
                isDragging = false;
            });

            // Filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentFilter = btn.dataset.filter;
                    layoutCards();
                    // Recenter after filter
                    setTimeout(centerCanvas, 50);
                });
            });

            document.getElementById('dismissInstructions').addEventListener('click', () => {
                document.getElementById('instructions').style.display = 'none';
            });
        }

        function zoom(delta, cx, cy) {
            const oldScale = scale;
            scale = Math.min(Math.max(scale * delta, 0.15), 5);

            if (cx !== undefined && cy !== undefined) {
                // Zoom toward cursor/touch point
                const rect = container.getBoundingClientRect();
                const x = cx - rect.left;
                const y = cy - rect.top;
                translateX = x - (x - translateX) * (scale / oldScale);
                translateY = y - (y - translateY) * (scale / oldScale);
            }

            updateTransform();
            zoomDisplay.textContent = `${Math.round(scale * 100)}%`;
        }

        function updateTransform() {
            canvas.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
        }

        function centerCanvas() {
            const rect = container.getBoundingClientRect();

            // Calculate scale to fit content with padding
            const scaleX = (rect.width - 100) / canvasWidth;
            const scaleY = (rect.height - 180) / canvasHeight;
            scale = Math.min(scaleX, scaleY, 1);
            scale = Math.max(scale, 0.2); // Minimum scale

            // Center the canvas
            translateX = (rect.width - canvasWidth * scale) / 2;
            translateY = (rect.height - canvasHeight * scale) / 2 + 30;

            updateTransform();
            zoomDisplay.textContent = `${Math.round(scale * 100)}%`;
        }

        function updateStats() {
            document.getElementById('totalCount').textContent = cooperatives.length;
            document.getElementById('visibleCount').textContent = cooperatives.length;
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
